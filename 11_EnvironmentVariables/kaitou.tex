\documentclass[a4j,dvipdfmx]{jarticle}
%----------------------------------------------------------------------
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{fancybox}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{color}
\usepackage{multicol}
\usepackage{listings,jlisting}
%----------------------------------------------------------------------
\pagestyle{fancy}
\lhead{2016/07/11}
\rhead{(\thepage / \pageref{LastPage})}
\cfoot{}
\chead{\textgt{システムプログラミング２　課題６解答}}
%----------------------------------------------------------------------
\begin{document}
\def\lstlistingname{リスト}
\lstset{language=C,
%  numbers=left,
  basicstyle={\small\ttfamily},
%  basicstyle={\ttfamily},
  commentstyle=\slshape,
  columns=[l]{fullflexible},
  keepspaces=true,
%  showspaces=true,
  frame=shadowbox
}

\begin{enumerate}
\item 現在時刻を日本語表記、モスクワ時間で表示する

\begin{lstlisting}[caption=日本語表記、モスクワ時間で表示する手順]
$ LC_TIME=ja_JP.UTF-8                       # 日本語表示にする
$ date
2016年 7月 7日 木曜日 22時23分03秒 JST
$ ls /usr/share/zoneinfo/                   # 使用できるタイムゾーンを調べる
+VERSION    Canada      GB          Iran        NZ-CHAT     UCT
Africa      Chile       GB-Eire     Israel      Navajo      US
America     Cuba        GMT         Jamaica     PRC         UTC
Antarctica  EET         GMT+0       Japan       PST8PDT     Universal
Arctic      EST         GMT-0       Kwajalein   Pacific     W-SU
Asia        EST5EDT     GMT0        Libya       Poland      WET
Atlantic    Egypt       Greenwich   MET         Portugal    Zulu
Australia   Eire        HST         MST         ROC         iso3166.tab
Brazil      Etc         Hongkong    MST7MDT     ROK         posixrules
CET         Europe      Iceland     Mexico      Singapore   zone.tab
CST6CDT     Factory     Indian      NZ          Turkey
$ ls /usr/share/zoneinfo/Europe/
Amsterdam   Busingen    Kiev        Moscow      Simferopol  Vienna
Andorra     Chisinau    Kirov       Nicosia     Skopje      Vilnius
Astrakhan   Copenhagen  Lisbon      Oslo        Sofia       Volgograd
Athens      Dublin      Ljubljana   Paris       Stockholm   Warsaw
Belfast     Gibraltar   London      Podgorica   Tallinn     Zagreb
Belgrade    Guernsey    Luxembourg  Prague      Tirane      Zaporozhye
Berlin      Helsinki    Madrid      Riga        Tiraspol    Zurich
Bratislava  Isle_of_Man Malta       Rome        Ulyanovsk
Brussels    Istanbul    Mariehamn   Samara      Uzhgorod
Bucharest   Jersey      Minsk       San_Marino  Vaduz
Budapest    Kaliningrad Monaco      Sarajevo    Vatican
$ export TZ=Europe/Moscow                  # モスクワはこれだろう
$ date                                     # モスクワ時間で表示してみる
2016年 7月 7日 木曜日 16時24分16秒 MSK   # 日本との時差は6時間、名前はMSK
$ TZ=MSK-3                                 # 世界標準時とは3時間
$ date                                     # これでもモスクワ時間になる
2016年 7月 7日 木曜日 16時24分29秒 MSK   # なった
$ TZ=JST-9                                 # 日本標準時(JST)を設定してみる
$ date                                     # 日本時間で表示されるはず
2016年 7月 7日 木曜日 22時24分44秒 JST
$
\end{lstlisting}

%\newpage

\item myprintenvを作る

本物の仕様を調べ、なるべく同じ動作をするようにmyprintenv を作る。

\begin{lstlisting}[caption=本物のprintenvの仕様を確認する]
$ printenv                # 引数なしの場合
SHELL=/bin/bash
TERM=xterm-256color
CLICOLOR=1
USER=sigemura
LANG=ja_JP.UTF-8
HOME=/Users/sigemura
LC_TIME=ja_JP.UTF-8
...
_=/usr/bin/printenv
$ printenv LANG           # 正しい引数一つの場合
ja_JP.UTF-8
$ printenv LLL            # 不正（？）な引数一つの場合
$ printenv LLL LANG       # 引数が複数の場合
$ printenv LANG LLL
ja_JP.UTF-8               # 最初の引数しか見ていない
$
\end{lstlisting}

\lstinputlisting[caption=myprintenv.c]{myprintenv.c}

\begin{lstlisting}[caption=myprintenvの動作確認]
$ cc -o myprintenv myprintenv.c 
$ myprintenv                          # 引数なしの場合
SHELL=/bin/bash
TERM=xterm-256color
CLICOLOR=1
USER=sigemura
...
LANG=ja_JP.UTF-8
LC_TIME=C
_=./myprintenv
$ myprintenv LANG                     # 正しい引数が１つだけの場合
ja_JP.UTF-8
$ myprintenv LLLL                     # 存在しない環境変数の場合
$ myprintenv LANG LC_TIME             # 複数の引数の場合
ja_JP.UTF-8
$
\end{lstlisting}

\end{enumerate}
\end{document}

